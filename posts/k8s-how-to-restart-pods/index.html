<!doctype html><html lang=en-us><head><title>K8s - How to restart Kubernetes Pods // Ana Cozma's Tech Blog</title><link rel="shortcut icon" href=/favicon.ico><meta charset=utf-8><meta name=generator content="Hugo 0.109.0"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Ana Cozma"><meta name=description content><link rel=stylesheet href=/blog/css/main.min.3c3c186cd62e563ad6e2f00a89dbee656ab912d1d46f856b5605dd0232521e2a.css><meta name=twitter:card content="summary"><meta name=twitter:title content="K8s - How to restart Kubernetes Pods"><meta name=twitter:description content="This article applies for Kubernetes v1.15 and above.
Kubernetes, also known as K8s, is an open-source system for automating deployment, scaling, and management of containerized applications.
It groups containers that make up an application into logical units for easy management and discovery. But what if something happens to the container? In this case, you might need a quick and easy way to restart it.
Kubernetes Pods usually run until there is a new deployment that will replace them."><meta property="og:title" content="K8s - How to restart Kubernetes Pods"><meta property="og:description" content="This article applies for Kubernetes v1.15 and above.
Kubernetes, also known as K8s, is an open-source system for automating deployment, scaling, and management of containerized applications.
It groups containers that make up an application into logical units for easy management and discovery. But what if something happens to the container? In this case, you might need a quick and easy way to restart it.
Kubernetes Pods usually run until there is a new deployment that will replace them."><meta property="og:type" content="article"><meta property="og:url" content="https://ana-cozma.github.io/blog/posts/k8s-how-to-restart-pods/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-25T12:35:04+01:00"><meta property="article:modified_time" content="2022-05-25T12:35:04+01:00"></head><body><header class=app-header><a href=https://ana-cozma.github.io/blog><img class=app-header-avatar src=/blog/avatar.jpg alt="Ana Cozma"></a>
<span class=app-header-title>Ana Cozma's Tech Blog</span><nav class=app-header-menu><a class=app-header-menu-item href=/blog/>Home</a>
|
<a class=app-header-menu-item href=/blog/about/>About</a>
|
<a class=app-header-menu-item href=/blog/tags/>Tags</a></nav><p>Tech and Tea - Navigating the World of Technology</p><div class=app-header-social><a href=https://github.com/ana-cozma target=_blank rel="noreferrer noopener me"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github"><title>GitHub</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a href=https://twitter.com/the_cozma target=_blank rel="noreferrer noopener me"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-twitter"><title>Twitter</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a><a href=https://www.linkedin.com/in/ana-cozma/ target=_blank rel="noreferrer noopener me"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-linkedin"><title>LinkedIn</title><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></div></header><main class=app-container><article class=post><header class=post-header><h1 class=post-title>K8s - How to restart Kubernetes Pods</h1><div class=post-meta><div><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>May 25, 2022</div><div><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock"><title>clock</title><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>3 min read</div><div><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag"><title>tag</title><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg><a class=tag href=https://ana-cozma.github.io/blog/tags/kubernetes/>kubernetes</a></div></div></header><div class=post-content><p>This article applies for <strong>Kubernetes v1.15</strong> and above.</p><p><a href=https://kubernetes.io/>Kubernetes</a>, also known as K8s, is an open-source system for automating deployment, scaling, and management of containerized applications.</p><p>It groups containers that make up an application into logical units for easy management and discovery. But what if something happens to the container? In this case, you might need a quick and easy way to restart it.</p><p><a href=https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/>Kubernetes Pods</a> usually run until there is a new deployment that will replace them. Therefore, there is no straightforward way to restart a single pod.</p><p>What happens when one container fails is that, instead of restarting it, it will be replaced.</p><h2 id=restarting-pods-options>Restarting Pods Options</h2><p>There are a few available options that we will cover in this article:</p><ol><li><p>Scaling down the number of replicas indicating how many Pods it should be maintaining in the ReplicaSet, effectively removing pods, then scaling back up
<strong>Causes downtime</strong></p></li><li><p>Deleting a single pod, forcing K8s to recreate it
<strong>Might cause downtime</strong></p></li><li><p>Starting a rollout (rolling restart method)
<strong>No downtime</strong></p></li></ol><p>So let&rsquo;s look at each option in a bit of details and keep in mind that each option could work for you depending on your needs. Some questions to ask: is it a live environment? is it a new setup? can you afford and outage on the app?</p><h2 id=1-changing-replicas>1. Changing Replicas</h2><p>An option for restarting the pods is to effectively &ldquo;shut them off&rdquo; by scaling the number of deployment replicas first to zero:</p><pre tabindex=0><code>kubectl scale deployment &lt;name&gt; --replicas=0
</code></pre><p>In this case, K8s will remove all the replicas that are no longer required.</p><p>And then, scaling them back up to the desired number.</p><pre tabindex=0><code>kubectl scale deployment &lt;name&gt; --replicas=&lt;desired_number&gt;
</code></pre><p>This will stop and terminate all current pods and will schedule new pods in their place.</p><p>Because we are &ldquo;shutting down&rdquo; pods, this option will cause downtime since there will be no container available. So if you&rsquo;re running on a production system the rolling restart method would be the better approach.</p><p>The names of the new scheduled pods <em>will</em> be different from the previous ones.</p><p>Run the following command to get the new names of the pods:</p><pre tabindex=0><code>kubectl get pods -n &lt;namespace&gt;
</code></pre><h2 id=2-deleting-a-pod>2. Deleting a Pod</h2><p>First we get all the pods in a namespace by running the following command:</p><pre tabindex=0><code>kubectl get pods -n &lt;namespace&gt;
</code></pre><p>Then we delete a single pod by running the following command:</p><pre tabindex=0><code>kubectl delete pod &lt;pod_name&gt; -n &lt;namespace&gt;
</code></pre><p>K8s will note the change and the state difference and will schedule new pods until the desired state is achieved.</p><h2 id=3-rolling-restart>3. Rolling Restart</h2><p>From version 1.15 K8s now allows you to execute a rolling restart of your deployment.
<em>Note: Not only the kubectl versions needs to be updated, but make sure the cluster is running on this version as well.</em></p><p>Rolling restart is used to restart all the pods from a deployment in sequence by running the following command:</p><pre tabindex=0><code>kubectl rollout restart deployment -n &lt;yournamespace&gt;
</code></pre><p>After running this command, K8s proceeds to shut down and restart each pod in the deployment one by one.</p><p>Because this is done sequentially, there is always some pod running meaning the application itself will still be available, effectively allowing for <strong>zero downtime</strong>.</p><p><em>Thank you for reading and I hope this helps someone!</em></p></div><div class=post-footer></div></article></main></body></html>